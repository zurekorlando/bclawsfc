<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Architect - Juego de Arquitectura</title>
    <link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --aws-orange: #FF9900;
            --aws-dark: #232F3E;
            --neon-green: #00ff41;
            --neon-red: #ff0040;
            --electric-blue: #00d4ff;
            --grid-color: rgba(255, 153, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Share Tech Mono', monospace;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px),
                linear-gradient(var(--grid-color) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            opacity: 0.3;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        h1 {
            font-family: 'Audiowide', cursive;
            font-size: 4rem;
            color: var(--aws-orange);
            text-shadow: 
                0 0 10px var(--aws-orange),
                0 0 20px var(--aws-orange),
                0 0 30px var(--aws-orange),
                0 0 40px #ff6600;
            letter-spacing: 5px;
            margin-bottom: 10px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                text-shadow: 
                    0 0 10px var(--aws-orange),
                    0 0 20px var(--aws-orange),
                    0 0 30px var(--aws-orange);
            }
            to {
                text-shadow: 
                    0 0 20px var(--aws-orange),
                    0 0 30px var(--aws-orange),
                    0 0 40px var(--aws-orange),
                    0 0 50px #ff6600;
            }
        }

        .subtitle {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--electric-blue);
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 153, 0, 0.1);
            border: 2px solid var(--aws-orange);
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .score-board {
            display: flex;
            gap: 30px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
        }

        .score-item {
            font-size: 1.2rem;
            color: var(--electric-blue);
        }

        .score-item span {
            color: var(--aws-orange);
            font-size: 1.5rem;
            margin-left: 10px;
        }

        .architecture-selector {
            position: relative;
        }

        .architecture-selector select {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            padding: 15px 25px;
            background: var(--aws-dark);
            color: var(--aws-orange);
            border: 2px solid var(--aws-orange);
            border-radius: 5px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            appearance: none;
            padding-right: 45px;
        }

        .architecture-selector select:hover {
            background: var(--aws-orange);
            color: var(--aws-dark);
            box-shadow: 0 0 20px var(--aws-orange);
        }

        .architecture-selector::after {
            content: '‚ñº';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            color: var(--aws-orange);
        }

        .instructions {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 30px;
            padding: 15px;
            background: rgba(0, 212, 255, 0.1);
            border: 2px solid var(--electric-blue);
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .instruction-item {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.95rem;
            color: var(--electric-blue);
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .game-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .components-panel {
            background: rgba(35, 47, 62, 0.8);
            border: 3px solid var(--aws-orange);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 30px rgba(255, 153, 0, 0.3);
        }

        .components-panel h2 {
            font-family: 'Orbitron', sans-serif;
            color: var(--electric-blue);
            margin-bottom: 20px;
            font-size: 1.3rem;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .components-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .component {
            background: linear-gradient(135deg, rgba(255, 153, 0, 0.2), rgba(0, 212, 255, 0.2));
            border: 2px solid var(--aws-orange);
            border-radius: 10px;
            padding: 15px;
            cursor: grab;
            text-align: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            font-size: 0.9rem;
            color: #fff;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .component::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .component:hover::before {
            left: 100%;
        }

        .component:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px var(--aws-orange);
            border-color: var(--electric-blue);
        }

        .component:active {
            cursor: grabbing;
        }

        .component-icon {
            font-size: 2rem;
            margin-bottom: 5px;
            display: block;
        }

        .architecture-board {
            background: rgba(35, 47, 62, 0.6);
            border: 3px solid var(--electric-blue);
            border-radius: 15px;
            padding: 40px;
            min-height: 600px;
            backdrop-filter: blur(10px);
            position: relative;
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.3);
        }

        .use-case-banner {
            background: linear-gradient(135deg, rgba(255, 153, 0, 0.15), rgba(0, 212, 255, 0.15));
            border: 2px solid var(--aws-orange);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .use-case-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            color: var(--aws-orange);
            font-weight: 700;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .use-case-scenario {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 12px;
            text-align: justify;
        }

        .use-case-benefits {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.85rem;
            color: var(--neon-green);
            padding: 10px;
            background: rgba(0, 255, 65, 0.05);
            border-radius: 8px;
            border-left: 3px solid var(--neon-green);
        }

        .architecture-title {
            font-family: 'Audiowide', cursive;
            font-size: 2rem;
            color: var(--aws-orange);
            text-align: center;
            margin-bottom: 40px;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .slots-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
            min-height: 400px;
        }

        .slot {
            width: 180px;
            height: 180px;
            border: 3px dashed var(--electric-blue);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.3s ease;
            background: rgba(0, 212, 255, 0.05);
        }

        .slot.drag-over {
            background: rgba(0, 212, 255, 0.2);
            border-color: var(--neon-green);
            transform: scale(1.1);
            box-shadow: 0 0 30px var(--neon-green);
        }

        .slot.filled {
            border-style: solid;
            border-color: var(--aws-orange);
            background: linear-gradient(135deg, rgba(255, 153, 0, 0.3), rgba(0, 212, 255, 0.3));
        }

        .slot-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            color: var(--electric-blue);
            margin-top: 10px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .slot .component {
            width: 100%;
            height: 100%;
            margin: 0;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .slot .component:hover {
            transform: scale(0.95);
            opacity: 0.8;
        }

        .slot .component::after {
            content: '‚úï';
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 0, 64, 0.8);
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .slot .component:hover::after {
            opacity: 1;
        }

        .arrow {
            font-size: 3rem;
            color: var(--aws-orange);
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .control-panel {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            padding: 30px;
            background: rgba(35, 47, 62, 0.8);
            border: 3px solid var(--aws-orange);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .btn {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            padding: 20px 40px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 700;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-verify {
            background: linear-gradient(135deg, var(--aws-orange), #ff6600);
            color: var(--aws-dark);
            box-shadow: 0 5px 15px rgba(255, 153, 0, 0.4);
        }

        .btn-verify:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 153, 0, 0.6);
        }

        .btn-reset {
            background: linear-gradient(135deg, #666, #888);
            color: #fff;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }

        .btn-reset:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
        }

        .status-led {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #333;
            border: 4px solid #555;
            position: relative;
            transition: all 0.5s ease;
        }

        .status-led.correct {
            background: var(--neon-green);
            border-color: var(--neon-green);
            box-shadow: 
                0 0 20px var(--neon-green),
                0 0 40px var(--neon-green),
                0 0 60px var(--neon-green),
                inset 0 0 20px rgba(255, 255, 255, 0.5);
            animation: correctBlink 0.5s ease-in-out 3;
        }

        .status-led.incorrect {
            background: var(--neon-red);
            border-color: var(--neon-red);
            box-shadow: 
                0 0 20px var(--neon-red),
                0 0 40px var(--neon-red),
                0 0 60px var(--neon-red),
                inset 0 0 20px rgba(255, 255, 255, 0.5);
            animation: incorrectBlink 0.5s ease-in-out 3;
        }

        @keyframes correctBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @keyframes incorrectBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @keyframes rippleOut {
            0% {
                width: 10px;
                height: 10px;
                opacity: 1;
            }
            100% {
                width: 200px;
                height: 200px;
                opacity: 0;
            }
        }

        .feedback-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: rgba(35, 47, 62, 0.98);
            border: 4px solid var(--aws-orange);
            border-radius: 20px;
            padding: 50px;
            text-align: center;
            z-index: 1000;
            font-family: 'Audiowide', cursive;
            font-size: 3rem;
            min-width: 400px;
            box-shadow: 0 0 100px rgba(0, 0, 0, 0.8);
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .feedback-message.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .feedback-message.correct {
            border-color: var(--neon-green);
            color: var(--neon-green);
            text-shadow: 0 0 20px var(--neon-green);
        }

        .feedback-message.incorrect {
            border-color: var(--neon-red);
            color: var(--neon-red);
            text-shadow: 0 0 20px var(--neon-red);
        }

        .hidden {
            display: none;
        }

        /* Login Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(35, 47, 62, 0.95), rgba(48, 43, 99, 0.95));
            border: 4px solid var(--aws-orange);
            border-radius: 20px;
            padding: 50px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 0 100px rgba(255, 153, 0, 0.5);
            animation: modalIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes modalIn {
            from {
                transform: scale(0.5);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-content h2 {
            font-family: 'Audiowide', cursive;
            font-size: 2.5rem;
            color: var(--aws-orange);
            margin-bottom: 20px;
            text-shadow: 0 0 20px var(--aws-orange);
        }

        .modal-content p {
            font-family: 'Orbitron', sans-serif;
            color: var(--electric-blue);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .input-group {
            margin-bottom: 30px;
        }

        .input-group input {
            width: 100%;
            padding: 20px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            background: rgba(35, 47, 62, 0.8);
            border: 2px solid var(--electric-blue);
            border-radius: 10px;
            color: #fff;
            text-align: center;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--aws-orange);
            box-shadow: 0 0 20px var(--aws-orange);
        }

        .input-group input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .btn-start {
            width: 100%;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            padding: 20px;
            background: linear-gradient(135deg, var(--aws-orange), #ff6600);
            color: var(--aws-dark);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 153, 0, 0.4);
        }

        .btn-start:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 153, 0, 0.6);
        }

        .btn-start:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Leaderboard */
        .leaderboard-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--electric-blue), #0099cc);
            color: white;
            border: 2px solid var(--electric-blue);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
            transition: all 0.3s ease;
        }

        .leaderboard-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.6);
        }

        .leaderboard-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: rgba(35, 47, 62, 0.98);
            border-left: 3px solid var(--electric-blue);
            padding: 30px;
            z-index: 1500;
            transition: right 0.4s ease;
            overflow-y: auto;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
        }

        .leaderboard-panel.open {
            right: 0;
        }

        .leaderboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .leaderboard-header h2 {
            font-family: 'Audiowide', cursive;
            font-size: 1.8rem;
            color: var(--electric-blue);
            text-shadow: 0 0 10px var(--electric-blue);
        }

        .close-leaderboard {
            background: none;
            border: none;
            color: var(--neon-red);
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-leaderboard:hover {
            transform: scale(1.2);
            text-shadow: 0 0 10px var(--neon-red);
        }

        .player-card {
            background: linear-gradient(135deg, rgba(255, 153, 0, 0.1), rgba(0, 212, 255, 0.1));
            border: 2px solid var(--aws-orange);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .player-card:hover {
            transform: translateX(-5px);
            box-shadow: 0 0 20px var(--aws-orange);
        }

        .player-card.current-player {
            border-color: var(--neon-green);
            box-shadow: 0 0 20px var(--neon-green);
        }

        .player-rank {
            font-family: 'Audiowide', cursive;
            font-size: 1.5rem;
            color: var(--aws-orange);
            min-width: 40px;
        }

        .player-rank.first {
            color: #FFD700;
            text-shadow: 0 0 10px #FFD700;
        }

        .player-rank.second {
            color: #C0C0C0;
            text-shadow: 0 0 10px #C0C0C0;
        }

        .player-rank.third {
            color: #CD7F32;
            text-shadow: 0 0 10px #CD7F32;
        }

        .player-info {
            flex: 1;
            margin: 0 15px;
        }

        .player-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            color: #fff;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .player-stats {
            font-size: 0.85rem;
            color: var(--electric-blue);
            font-family: 'Share Tech Mono', monospace;
        }

        .player-score {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--neon-green);
            font-weight: 700;
            text-shadow: 0 0 10px var(--neon-green);
        }

        .current-player-display {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 25px;
            background: rgba(0, 255, 65, 0.1);
            border: 2px solid var(--neon-green);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .current-player-display .player-icon {
            font-size: 2rem;
        }

        .current-player-display .player-text {
            font-family: 'Orbitron', sans-serif;
            color: var(--neon-green);
            font-weight: 700;
            font-size: 1.1rem;
        }

        .reference-link {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 212, 255, 0.1);
            border: 2px solid var(--electric-blue);
            border-radius: 10px;
            animation: fadeIn 0.5s ease;
        }

        .reference-link h4 {
            font-family: 'Orbitron', sans-serif;
            color: var(--electric-blue);
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .reference-link a {
            display: inline-block;
            padding: 15px 30px;
            background: linear-gradient(135deg, var(--electric-blue), #0099cc);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            transition: all 0.3s ease;
            word-break: break-all;
        }

        .reference-link a:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px var(--electric-blue);
        }

        .reference-description {
            font-family: 'Share Tech Mono', monospace;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Admin Panel */
        .admin-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #666, #888);
            color: white;
            border: 2px solid #888;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
        }

        .admin-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
        }

        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            z-index: 3000;
            overflow-y: auto;
            padding: 40px;
            display: none;
        }

        .admin-panel.open {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background: linear-gradient(135deg, rgba(35, 47, 62, 0.95), rgba(48, 43, 99, 0.95));
            border: 3px solid var(--aws-orange);
            border-radius: 20px;
            padding: 40px;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--aws-orange);
        }

        .admin-header h2 {
            font-family: 'Audiowide', cursive;
            font-size: 2.5rem;
            color: var(--aws-orange);
            text-shadow: 0 0 20px var(--aws-orange);
        }

        .close-admin {
            background: none;
            border: 2px solid var(--neon-red);
            color: var(--neon-red);
            font-size: 1.5rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-admin:hover {
            background: var(--neon-red);
            color: white;
            transform: scale(1.1);
        }

        .admin-section {
            margin-bottom: 40px;
        }

        .admin-section h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--electric-blue);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255, 153, 0, 0.2), rgba(0, 212, 255, 0.2));
            border: 2px solid var(--aws-orange);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-family: 'Audiowide', cursive;
            font-size: 3rem;
            color: var(--neon-green);
            text-shadow: 0 0 10px var(--neon-green);
        }

        .stat-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            color: var(--electric-blue);
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .admin-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .admin-btn {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-btn-export {
            background: linear-gradient(135deg, var(--neon-green), #00cc33);
            color: var(--aws-dark);
        }

        .admin-btn-import {
            background: linear-gradient(135deg, var(--electric-blue), #0099cc);
            color: white;
        }

        .admin-btn-clear {
            background: linear-gradient(135deg, var(--neon-red), #cc0033);
            color: white;
        }

        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(35, 47, 62, 0.5);
            border-radius: 10px;
            overflow: hidden;
        }

        .admin-table th {
            background: linear-gradient(135deg, var(--aws-orange), #ff6600);
            color: var(--aws-dark);
            padding: 15px;
            text-align: left;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        .admin-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 153, 0, 0.2);
            font-family: 'Share Tech Mono', monospace;
            color: rgba(255, 255, 255, 0.9);
        }

        .admin-table tr:hover {
            background: rgba(255, 153, 0, 0.1);
        }

        .admin-table .rank-cell {
            font-family: 'Audiowide', cursive;
            font-size: 1.2rem;
            color: var(--aws-orange);
        }

        .import-area {
            width: 100%;
            min-height: 150px;
            background: rgba(35, 47, 62, 0.8);
            border: 2px dashed var(--electric-blue);
            border-radius: 10px;
            padding: 20px;
            font-family: 'Share Tech Mono', monospace;
            color: #fff;
            font-size: 0.9rem;
            resize: vertical;
        }

        .import-area:focus {
            outline: none;
            border-color: var(--neon-green);
        }

        .session-code {
            background: rgba(0, 212, 255, 0.1);
            border: 2px solid var(--electric-blue);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-top: 20px;
        }

        .session-code-value {
            font-family: 'Audiowide', cursive;
            font-size: 2rem;
            color: var(--electric-blue);
            text-shadow: 0 0 10px var(--electric-blue);
            letter-spacing: 3px;
            margin: 10px 0;
            user-select: all;
        }

        .info-box {
            background: rgba(0, 212, 255, 0.1);
            border-left: 4px solid var(--electric-blue);
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }

        @media (max-width: 1200px) {
            .game-container {
                grid-template-columns: 1fr;
            }

            .components-panel {
                order: 2;
            }

            .components-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }

            .instructions {
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }

            .leaderboard-panel {
                width: 100%;
                right: -100%;
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .slots-container {
                flex-direction: column;
            }

            .control-panel {
                flex-direction: column;
            }

            .game-info {
                flex-direction: column;
                gap: 15px;
            }

            .score-board {
                flex-direction: column;
                gap: 10px;
            }

            .instructions {
                font-size: 0.85rem;
            }

            .modal-content {
                padding: 30px;
                max-width: 90%;
            }

            .modal-content h2 {
                font-size: 2rem;
            }

            .leaderboard-toggle {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
                top: 10px;
                right: 10px;
            }

            .admin-toggle {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
                bottom: 10px;
                right: 10px;
            }

            .current-player-display {
                padding: 10px 15px;
                font-size: 0.9rem;
            }

            .feedback-message {
                padding: 30px;
                font-size: 2rem;
                min-width: 300px;
            }

            .reference-link {
                padding: 15px;
            }

            .reference-link h4 {
                font-size: 0.95rem;
            }

            .reference-link a {
                padding: 12px 20px;
                font-size: 0.85rem;
            }

            .use-case-banner {
                padding: 15px;
            }

            .use-case-title {
                font-size: 1.1rem;
            }

            .use-case-scenario {
                font-size: 0.85rem;
            }

            .use-case-benefits {
                font-size: 0.8rem;
            }

            .admin-panel {
                padding: 20px;
            }

            .admin-container {
                padding: 20px;
            }

            .admin-header h2 {
                font-size: 1.8rem;
            }

            .admin-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .stat-value {
                font-size: 2rem;
            }

            .admin-actions {
                flex-direction: column;
            }

            .admin-btn {
                width: 100%;
            }

            .admin-table {
                font-size: 0.8rem;
            }

            .admin-table th,
            .admin-table td {
                padding: 8px;
            }

            .session-code-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AWS ARCHITECT</h1>
            <p class="subtitle">Construye la arquitectura correcta</p>
        </header>

        <div class="current-player-display" id="current-player-display">
            <span class="player-icon">üë§</span>
            <span class="player-text">Jugador: <span id="current-player-name">-</span></span>
        </div>

        <div class="game-info">
            <div class="score-board">
                <div class="score-item">
                    Correctas: <span id="correct-count">0</span>
                </div>
                <div class="score-item">
                    Intentos: <span id="attempt-count">0</span>
                </div>
                <div class="score-item">
                    Score: <span id="score">0</span>%
                </div>
            </div>
            <div class="architecture-selector">
                <select id="architecture-select">
                    <option value="0">üöÄ Serverless Web App</option>
                    <option value="1">üîß Microservices Platform</option>
                    <option value="2">üì± Static Website</option>
                    <option value="3">üìä Data Pipeline</option>
                    <option value="4">üèóÔ∏è Three-Tier App</option>
                </select>
            </div>
        </div>

        <div class="instructions">
            <div class="instruction-item">üì¶ Arrastra componentes a los slots</div>
            <div class="instruction-item">‚úï Click en un componente para quitarlo</div>
            <div class="instruction-item">üéØ Verifica tu arquitectura</div>
        </div>

        <div class="game-container">
            <div class="components-panel">
                <h2>‚ö° Componentes AWS</h2>
                <div class="components-grid" id="components-grid">
                    <!-- Los componentes se generar√°n din√°micamente -->
                </div>
            </div>

            <div class="architecture-board">
                <h3 class="architecture-title" id="architecture-name">Serverless Web App</h3>
                
                <div class="use-case-banner" id="use-case-banner">
                    <div class="use-case-title">
                        <span>üíº</span>
                        <span id="use-case-title">Caso de Uso</span>
                    </div>
                    <div class="use-case-scenario" id="use-case-scenario"></div>
                    <div class="use-case-benefits" id="use-case-benefits"></div>
                </div>

                <div class="slots-container" id="slots-container">
                    <!-- Los slots se generar√°n din√°micamente -->
                </div>
            </div>
        </div>

        <div class="control-panel">
            <button class="btn btn-verify" id="verify-btn">üéØ Verificar</button>
            <div class="status-led" id="status-led"></div>
            <button class="btn btn-reset" id="reset-btn">üîÑ Reset</button>
        </div>
    </div>

    <div class="feedback-message" id="feedback-message"></div>

    <!-- Login Modal -->
    <div class="modal-overlay" id="login-modal">
        <div class="modal-content">
            <h2>üéÆ BIENVENIDO</h2>
            <p>Ingresa tu nickname para comenzar</p>
            <div class="input-group">
                <input 
                    type="text" 
                    id="player-nickname" 
                    placeholder="Tu nickname aqu√≠..." 
                    maxlength="20"
                    autocomplete="off"
                />
            </div>
            <button class="btn-start" id="start-game-btn" disabled>
                üöÄ COMENZAR A JUGAR
            </button>
        </div>
    </div>

    <!-- Leaderboard Toggle -->
    <button class="leaderboard-toggle" id="leaderboard-toggle" style="display: none;">
        üèÜ
    </button>

    <!-- Leaderboard Panel -->
    <div class="leaderboard-panel" id="leaderboard-panel">
        <div class="leaderboard-header">
            <h2>üèÜ RANKING</h2>
            <button class="close-leaderboard" id="close-leaderboard">‚úï</button>
        </div>
        <div id="leaderboard-content">
            <!-- Players will be inserted here -->
        </div>
    </div>

    <!-- Admin Toggle -->
    <button class="admin-toggle" id="admin-toggle" style="display: none;">
        ‚öôÔ∏è
    </button>

    <!-- Admin Panel -->
    <div class="admin-panel" id="admin-panel">
        <div class="admin-container">
            <div class="admin-header">
                <h2>üéØ PANEL DE ADMINISTRACI√ìN</h2>
                <button class="close-admin" id="close-admin">‚úï</button>
            </div>

            <!-- Estad√≠sticas Generales -->
            <div class="admin-section">
                <h3>üìä Estad√≠sticas Generales</h3>
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-total-players">0</div>
                        <div class="stat-label">Jugadores</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-total-attempts">0</div>
                        <div class="stat-label">Intentos Totales</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-avg-score">0%</div>
                        <div class="stat-label">Score Promedio</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-completion">0</div>
                        <div class="stat-label">Arquitecturas Completadas</div>
                    </div>
                </div>
            </div>

            <!-- C√≥digo de Sesi√≥n -->
            <div class="admin-section">
                <h3>üîó C√≥digo de Sesi√≥n</h3>
                <div class="info-box">
                    üì§ Comparte este c√≥digo con tus compa√±eros para que puedan enviar sus resultados.
                    Los jugadores pueden ir al panel de administraci√≥n y usar "Importar Datos" con este c√≥digo.
                </div>
                <div class="session-code">
                    <div>ID de Sesi√≥n</div>
                    <div class="session-code-value" id="session-code">LOADING...</div>
                    <button class="admin-btn admin-btn-export" onclick="copySessionCode()">
                        üìã Copiar C√≥digo
                    </button>
                </div>
            </div>

            <!-- Acciones -->
            <div class="admin-section">
                <h3>‚ö° Acciones</h3>
                <div class="admin-actions">
                    <button class="admin-btn admin-btn-export" id="export-json-btn">
                        üíæ Exportar JSON
                    </button>
                    <button class="admin-btn admin-btn-export" id="export-csv-btn">
                        üìä Exportar CSV
                    </button>
                    <button class="admin-btn admin-btn-import" id="import-data-btn">
                        üì• Importar Datos
                    </button>
                    <button class="admin-btn admin-btn-clear" id="clear-all-btn">
                        üóëÔ∏è Limpiar Todo
                    </button>
                </div>

                <!-- Import Area (hidden by default) -->
                <div id="import-section" style="display: none; margin-top: 20px;">
                    <h4 style="color: var(--electric-blue); font-family: 'Orbitron', sans-serif; margin-bottom: 10px;">
                        Pega aqu√≠ el JSON exportado:
                    </h4>
                    <textarea class="import-area" id="import-textarea" placeholder='[{"nickname":"Juan","correctCount":3,...}]'></textarea>
                    <div style="margin-top: 15px; display: flex; gap: 10px;">
                        <button class="admin-btn admin-btn-export" id="process-import-btn">
                            ‚úÖ Importar
                        </button>
                        <button class="admin-btn admin-btn-clear" id="cancel-import-btn">
                            ‚úï Cancelar
                        </button>
                    </div>
                    <div class="info-box" style="margin-top: 15px;">
                        üí° <strong>Tip:</strong> Los jugadores pueden exportar sus datos individuales y envi√°rtelos.
                        Luego puedes importarlos aqu√≠ para consolidar todos los resultados.
                    </div>
                </div>
            </div>

            <!-- Tabla de Resultados -->
            <div class="admin-section">
                <h3>üìã Todos los Resultados</h3>
                <div style="overflow-x: auto;">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Nickname</th>
                                <th>Score</th>
                                <th>Correctas</th>
                                <th>Intentos</th>
                                <th>Arquitecturas Completadas</th>
                                <th>√öltima Jugada</th>
                            </tr>
                        </thead>
                        <tbody id="admin-table-body">
                            <!-- Rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Definici√≥n de arquitecturas
        const architectures = [
            {
                name: "Serverless Web App",
                icon: "üöÄ",
                referenceUrl: "https://aws.amazon.com/architecture/reference-architecture-diagrams/?solutions-all.sort-by=item.additionalFields.sortDate&solutions-all.sort-order=desc&whitepapers-main.sort-by=item.additionalFields.sortDate&whitepapers-main.sort-order=desc&awsf.whitepapers-tech-category=tech-category%23serverless",
                description: "Arquitectura serverless usando API Gateway, Lambda y DynamoDB",
                useCase: {
                    title: "Sistema de Reservas Online",
                    scenario: "Una cadena hotelera necesita un sistema de reservas que escale autom√°ticamente durante temporada alta, sin pagar por servidores ociosos en temporada baja. La soluci√≥n debe ser de bajo costo operacional y alta disponibilidad.",
                    benefits: "‚úì Pago por uso ‚úì Escalabilidad autom√°tica ‚úì Zero mantenimiento de servidores ‚úì Alta disponibilidad"
                },
                slots: [
                    { id: "api", label: "API Layer", correct: "API Gateway" },
                    { id: "compute", label: "Compute", correct: "Lambda" },
                    { id: "database", label: "Database", correct: "DynamoDB" }
                ]
            },
            {
                name: "Microservices Platform",
                icon: "üîß",
                referenceUrl: "https://aws.amazon.com/architecture/microservices/",
                description: "Plataforma de microservicios con containers y balanceo de carga",
                useCase: {
                    title: "Plataforma de E-commerce",
                    scenario: "Una empresa de comercio electr√≥nico necesita separar sus servicios (cat√°logo, carrito, pagos, inventario) para que equipos independientes puedan desarrollar y desplegar sin afectar a otros. Requiere alta disponibilidad y capacidad de escalar servicios espec√≠ficos seg√∫n demanda.",
                    benefits: "‚úì Despliegue independiente ‚úì Escalabilidad por servicio ‚úì Resiliencia ‚úì Tecnolog√≠as heterog√©neas"
                },
                slots: [
                    { id: "loadbalancer", label: "Load Balancer", correct: "ALB" },
                    { id: "container", label: "Container Service", correct: "ECS" },
                    { id: "database", label: "Database", correct: "RDS" },
                    { id: "cache", label: "Cache", correct: "ElastiCache" }
                ]
            },
            {
                name: "Static Website",
                icon: "üì±",
                referenceUrl: "https://aws.amazon.com/getting-started/hands-on/host-static-website/",
                description: "Sitio web est√°tico con CDN y almacenamiento en S3",
                useCase: {
                    title: "Portal Corporativo Global",
                    scenario: "Una multinacional necesita publicar su sitio web corporativo (HTML, CSS, JS) con presencia en m√∫ltiples regiones, entrega ultra-r√°pida de contenido, certificado SSL y costos m√≠nimos de hosting. El contenido es principalmente est√°tico con actualizaciones ocasionales.",
                    benefits: "‚úì Distribuci√≥n global ‚úì Ultra bajo costo ‚úì Alta velocidad ‚úì HTTPS incluido"
                },
                slots: [
                    { id: "dns", label: "DNS", correct: "Route 53" },
                    { id: "cdn", label: "CDN", correct: "CloudFront" },
                    { id: "storage", label: "Storage", correct: "S3" }
                ]
            },
            {
                name: "Data Pipeline",
                icon: "üìä",
                referenceUrl: "https://aws.amazon.com/architecture/analytics-big-data/",
                description: "Pipeline de datos con procesamiento serverless y streaming",
                useCase: {
                    title: "Analytics de IoT en Tiempo Real",
                    scenario: "Una empresa de log√≠stica tiene 10,000 sensores en camiones enviando datos cada segundo (temperatura, ubicaci√≥n, combustible). Necesitan procesar este streaming de datos en tiempo real, almacenarlos para an√°lisis hist√≥rico y generar reportes ejecutivos.",
                    benefits: "‚úì Procesamiento en tiempo real ‚úì Almacenamiento escalable ‚úì Analytics avanzados ‚úì Bajo costo"
                },
                slots: [
                    { id: "source", label: "Data Source", correct: "S3" },
                    { id: "processing", label: "Processing", correct: "Lambda" },
                    { id: "streaming", label: "Streaming", correct: "Kinesis" },
                    { id: "warehouse", label: "Data Warehouse", correct: "Redshift" }
                ]
            },
            {
                name: "Three-Tier Application",
                icon: "üèóÔ∏è",
                referenceUrl: "https://docs.aws.amazon.com/whitepapers/latest/aws-overview/three-tier-architecture.html",
                description: "Aplicaci√≥n de tres capas cl√°sica con balanceador, compute y base de datos",
                useCase: {
                    title: "Sistema ERP Empresarial",
                    scenario: "Una empresa manufacturera necesita migrar su sistema ERP legacy a la nube. La aplicaci√≥n requiere alta disponibilidad, balanceo de carga entre m√∫ltiples servidores, base de datos relacional con backups autom√°ticos y capacidad de crecer conforme aumenten los usuarios.",
                    benefits: "‚úì Alta disponibilidad ‚úì Separaci√≥n de capas ‚úì Escalabilidad controlada ‚úì Backups autom√°ticos"
                },
                slots: [
                    { id: "loadbalancer", label: "Load Balancer", correct: "ELB" },
                    { id: "compute", label: "Compute", correct: "EC2" },
                    { id: "database", label: "Database", correct: "RDS" }
                ]
            }
        ];

        // Componentes AWS disponibles
        const awsComponents = [
            { name: "API Gateway", icon: "üîå" },
            { name: "Lambda", icon: "Œª" },
            { name: "DynamoDB", icon: "üóÑÔ∏è" },
            { name: "ALB", icon: "‚öñÔ∏è" },
            { name: "ECS", icon: "üê≥" },
            { name: "RDS", icon: "üóÉÔ∏è" },
            { name: "ElastiCache", icon: "‚ö°" },
            { name: "Route 53", icon: "üåê" },
            { name: "CloudFront", icon: "‚òÅÔ∏è" },
            { name: "S3", icon: "ü™£" },
            { name: "Kinesis", icon: "üåä" },
            { name: "Redshift", icon: "üìä" },
            { name: "ELB", icon: "üîÄ" },
            { name: "EC2", icon: "üíª" }
        ];

        // Estado del juego
        let currentArchitecture = 0;
        let correctCount = 0;
        let attemptCount = 0;
        let placedComponents = {};
        let autoScrollInterval = null;
        let isDragging = false;
        let currentPlayer = null;
        let players = [];

        // Referencias DOM
        const componentsGrid = document.getElementById('components-grid');
        const slotsContainer = document.getElementById('slots-container');
        const architectureSelect = document.getElementById('architecture-select');
        const architectureName = document.getElementById('architecture-name');
        const verifyBtn = document.getElementById('verify-btn');
        const resetBtn = document.getElementById('reset-btn');
        const statusLed = document.getElementById('status-led');
        const feedbackMessage = document.getElementById('feedback-message');
        const correctCountEl = document.getElementById('correct-count');
        const attemptCountEl = document.getElementById('attempt-count');
        const scoreEl = document.getElementById('score');
        const loginModal = document.getElementById('login-modal');
        const playerNicknameInput = document.getElementById('player-nickname');
        const startGameBtn = document.getElementById('start-game-btn');
        const currentPlayerDisplay = document.getElementById('current-player-display');
        const currentPlayerName = document.getElementById('current-player-name');
        const leaderboardToggle = document.getElementById('leaderboard-toggle');
        const leaderboardPanel = document.getElementById('leaderboard-panel');
        const closeLeaderboard = document.getElementById('close-leaderboard');
        const leaderboardContent = document.getElementById('leaderboard-content');
        
        // Use Case elements
        const useCaseTitle = document.getElementById('use-case-title');
        const useCaseScenario = document.getElementById('use-case-scenario');
        const useCaseBenefits = document.getElementById('use-case-benefits');
        
        // Admin panel elements
        const adminToggle = document.getElementById('admin-toggle');
        const adminPanel = document.getElementById('admin-panel');
        const closeAdmin = document.getElementById('close-admin');
        const exportJsonBtn = document.getElementById('export-json-btn');
        const exportCsvBtn = document.getElementById('export-csv-btn');
        const importDataBtn = document.getElementById('import-data-btn');
        const clearAllBtn = document.getElementById('clear-all-btn');
        const importSection = document.getElementById('import-section');
        const importTextarea = document.getElementById('import-textarea');
        const processImportBtn = document.getElementById('process-import-btn');
        const cancelImportBtn = document.getElementById('cancel-import-btn');
        const adminTableBody = document.getElementById('admin-table-body');
        const sessionCodeEl = document.getElementById('session-code');

        // Player Management Functions
        function loadPlayers() {
            const stored = localStorage.getItem('awsArchitectPlayers');
            players = stored ? JSON.parse(stored) : [];
        }

        function savePlayers() {
            localStorage.setItem('awsArchitectPlayers', JSON.stringify(players));
        }

        function createOrUpdatePlayer(nickname) {
            let player = players.find(p => p.nickname.toLowerCase() === nickname.toLowerCase());
            
            if (!player) {
                player = {
                    nickname: nickname,
                    correctCount: 0,
                    attemptCount: 0,
                    score: 0,
                    completedArchitectures: [],
                    lastPlayed: new Date().toISOString()
                };
                players.push(player);
            } else {
                player.lastPlayed = new Date().toISOString();
            }
            
            currentPlayer = player;
            correctCount = player.correctCount;
            attemptCount = player.attemptCount;
            savePlayers();
            updateScore();
        }

        function updatePlayerStats() {
            if (!currentPlayer) return;
            
            currentPlayer.correctCount = correctCount;
            currentPlayer.attemptCount = attemptCount;
            currentPlayer.score = attemptCount > 0 ? Math.round((correctCount / attemptCount) * 100) : 0;
            currentPlayer.lastPlayed = new Date().toISOString();
            
            savePlayers();
            updateLeaderboard();
        }

        function addCompletedArchitecture(archIndex) {
            if (!currentPlayer) return;
            
            const archName = architectures[archIndex].name;
            if (!currentPlayer.completedArchitectures.includes(archName)) {
                currentPlayer.completedArchitectures.push(archName);
                savePlayers();
            }
        }

        function updateLeaderboard() {
            const sortedPlayers = [...players].sort((a, b) => {
                if (b.score !== a.score) return b.score - a.score;
                return b.correctCount - a.correctCount;
            });

            leaderboardContent.innerHTML = '';
            
            sortedPlayers.forEach((player, index) => {
                const rank = index + 1;
                const isCurrentPlayer = currentPlayer && player.nickname === currentPlayer.nickname;
                
                const card = document.createElement('div');
                card.className = `player-card ${isCurrentPlayer ? 'current-player' : ''}`;
                
                let rankClass = '';
                if (rank === 1) rankClass = 'first';
                else if (rank === 2) rankClass = 'second';
                else if (rank === 3) rankClass = 'third';
                
                card.innerHTML = `
                    <div class="player-rank ${rankClass}">#${rank}</div>
                    <div class="player-info">
                        <div class="player-name">${player.nickname} ${isCurrentPlayer ? '(T√∫)' : ''}</div>
                        <div class="player-stats">
                            ‚úì ${player.correctCount} | ‚úó ${player.attemptCount - player.correctCount} | 
                            üèóÔ∏è ${player.completedArchitectures.length}/5
                        </div>
                    </div>
                    <div class="player-score">${player.score}%</div>
                `;
                
                leaderboardContent.appendChild(card);
            });
        }

        // Admin Functions
        function generateSessionCode() {
            const timestamp = Date.now().toString(36);
            const random = Math.random().toString(36).substring(2, 8);
            return `AWS-${timestamp}-${random}`.toUpperCase();
        }

        function updateAdminStats() {
            const totalPlayers = players.length;
            const totalAttempts = players.reduce((sum, p) => sum + p.attemptCount, 0);
            const avgScore = totalPlayers > 0 
                ? Math.round(players.reduce((sum, p) => sum + p.score, 0) / totalPlayers)
                : 0;
            const totalCompletions = players.reduce((sum, p) => sum + p.completedArchitectures.length, 0);

            document.getElementById('stat-total-players').textContent = totalPlayers;
            document.getElementById('stat-total-attempts').textContent = totalAttempts;
            document.getElementById('stat-avg-score').textContent = avgScore + '%';
            document.getElementById('stat-completion').textContent = totalCompletions;

            // Update session code
            let sessionCode = localStorage.getItem('awsArchitectSessionCode');
            if (!sessionCode) {
                sessionCode = generateSessionCode();
                localStorage.setItem('awsArchitectSessionCode', sessionCode);
            }
            sessionCodeEl.textContent = sessionCode;

            // Update table
            updateAdminTable();
        }

        function updateAdminTable() {
            const sortedPlayers = [...players].sort((a, b) => {
                if (b.score !== a.score) return b.score - a.score;
                return b.correctCount - a.correctCount;
            });

            adminTableBody.innerHTML = '';
            
            sortedPlayers.forEach((player, index) => {
                const row = document.createElement('tr');
                const lastPlayed = new Date(player.lastPlayed).toLocaleString('es-CO', {
                    dateStyle: 'short',
                    timeStyle: 'short'
                });
                
                row.innerHTML = `
                    <td class="rank-cell">#${index + 1}</td>
                    <td>${player.nickname}</td>
                    <td style="color: var(--neon-green); font-weight: bold;">${player.score}%</td>
                    <td>${player.correctCount}</td>
                    <td>${player.attemptCount}</td>
                    <td>${player.completedArchitectures.join(', ') || 'Ninguna'}</td>
                    <td style="font-size: 0.8rem;">${lastPlayed}</td>
                `;
                
                adminTableBody.appendChild(row);
            });
        }

        function exportToJSON() {
            const data = {
                sessionCode: localStorage.getItem('awsArchitectSessionCode'),
                exportDate: new Date().toISOString(),
                players: players
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `aws-architect-results-${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showFeedback('‚úÖ Datos exportados a JSON', true);
        }

        function exportToCSV() {
            const headers = ['Rank', 'Nickname', 'Score', 'Correct', 'Attempts', 'Architectures', 'Last Played'];
            const sortedPlayers = [...players].sort((a, b) => {
                if (b.score !== a.score) return b.score - a.score;
                return b.correctCount - a.correctCount;
            });
            
            const rows = sortedPlayers.map((player, index) => [
                index + 1,
                player.nickname,
                player.score + '%',
                player.correctCount,
                player.attemptCount,
                player.completedArchitectures.join(';') || 'None',
                new Date(player.lastPlayed).toLocaleString()
            ]);
            
            const csvContent = [
                headers.join(','),
                ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `aws-architect-results-${Date.now()}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showFeedback('‚úÖ Datos exportados a CSV', true);
        }

        function showImportSection() {
            importSection.style.display = 'block';
            importTextarea.value = '';
            importTextarea.focus();
        }

        function hideImportSection() {
            importSection.style.display = 'none';
            importTextarea.value = '';
        }

        function processImport() {
            try {
                const importedData = JSON.parse(importTextarea.value);
                let importedPlayers = [];
                
                // Handle both array of players and full export format
                if (Array.isArray(importedData)) {
                    importedPlayers = importedData;
                } else if (importedData.players && Array.isArray(importedData.players)) {
                    importedPlayers = importedData.players;
                } else {
                    throw new Error('Formato inv√°lido');
                }
                
                // Merge imported players with existing ones
                let mergedCount = 0;
                let newCount = 0;
                
                importedPlayers.forEach(importedPlayer => {
                    const existingIndex = players.findIndex(
                        p => p.nickname.toLowerCase() === importedPlayer.nickname.toLowerCase()
                    );
                    
                    if (existingIndex >= 0) {
                        // Merge: keep the best stats
                        const existing = players[existingIndex];
                        existing.correctCount = Math.max(existing.correctCount, importedPlayer.correctCount);
                        existing.attemptCount = Math.max(existing.attemptCount, importedPlayer.attemptCount);
                        existing.score = Math.max(existing.score, importedPlayer.score);
                        
                        // Merge completed architectures
                        const allArchs = new Set([
                            ...existing.completedArchitectures,
                            ...(importedPlayer.completedArchitectures || [])
                        ]);
                        existing.completedArchitectures = Array.from(allArchs);
                        
                        // Update last played
                        if (new Date(importedPlayer.lastPlayed) > new Date(existing.lastPlayed)) {
                            existing.lastPlayed = importedPlayer.lastPlayed;
                        }
                        
                        mergedCount++;
                    } else {
                        // Add new player
                        players.push(importedPlayer);
                        newCount++;
                    }
                });
                
                savePlayers();
                updateLeaderboard();
                updateAdminStats();
                hideImportSection();
                
                showFeedback(
                    `‚úÖ Importaci√≥n completada: ${newCount} nuevos, ${mergedCount} actualizados`,
                    true
                );
            } catch (error) {
                showFeedback('‚ùå Error al importar: ' + error.message, false);
            }
        }

        function clearAllData() {
            if (confirm('‚ö†Ô∏è ¬øEst√°s seguro de eliminar TODOS los datos? Esta acci√≥n no se puede deshacer.')) {
                if (confirm('üî¥ √öLTIMA CONFIRMACI√ìN: ¬øEliminar todos los jugadores y resultados?')) {
                    players = [];
                    currentPlayer = null;
                    correctCount = 0;
                    attemptCount = 0;
                    localStorage.removeItem('awsArchitectPlayers');
                    localStorage.removeItem('awsArchitectSessionCode');
                    savePlayers();
                    updateLeaderboard();
                    updateAdminStats();
                    showFeedback('üóëÔ∏è Todos los datos han sido eliminados', true);
                }
            }
        }

        function copySessionCode() {
            const code = sessionCodeEl.textContent;
            navigator.clipboard.writeText(code).then(() => {
                showFeedback('üìã C√≥digo copiado al portapapeles', true);
            }).catch(() => {
                showFeedback('‚ùå Error al copiar c√≥digo', false);
            });
        }

        // Inicializar juego
        function initGame() {
            renderComponents();
            loadArchitecture(currentArchitecture);
        }

        // Renderizar componentes disponibles
        function renderComponents() {
            componentsGrid.innerHTML = '';
            awsComponents.forEach(component => {
                const div = document.createElement('div');
                div.className = 'component';
                div.draggable = true;
                div.dataset.component = component.name;
                div.innerHTML = `
                    <span class="component-icon">${component.icon}</span>
                    <div>${component.name}</div>
                `;
                
                div.addEventListener('dragstart', handleDragStart);
                componentsGrid.appendChild(div);
            });
        }

        // Cargar arquitectura
        function loadArchitecture(index) {
            const arch = architectures[index];
            architectureName.textContent = `${arch.icon} ${arch.name}`;
            placedComponents = {};
            
            // Cargar caso de uso
            if (arch.useCase) {
                useCaseTitle.textContent = arch.useCase.title;
                useCaseScenario.textContent = arch.useCase.scenario;
                useCaseBenefits.textContent = arch.useCase.benefits;
            }
            
            slotsContainer.innerHTML = '';
            
            arch.slots.forEach((slot, slotIndex) => {
                const slotDiv = document.createElement('div');
                slotDiv.className = 'slot';
                slotDiv.dataset.slotId = slot.id;
                slotDiv.dataset.correctComponent = slot.correct;
                
                slotDiv.innerHTML = `<div class="slot-label">${slot.label}</div>`;
                
                slotDiv.addEventListener('dragover', handleDragOver);
                slotDiv.addEventListener('drop', handleDrop);
                slotDiv.addEventListener('dragleave', handleDragLeave);
                
                // Agregar tooltip con instrucciones
                slotDiv.title = 'Arrastra aqu√≠ un componente AWS. Click en el componente para quitarlo.';
                
                slotsContainer.appendChild(slotDiv);
                
                // A√±adir flechas entre slots (excepto el √∫ltimo)
                if (slotIndex < arch.slots.length - 1) {
                    const arrow = document.createElement('div');
                    arrow.className = 'arrow';
                    arrow.textContent = '‚Üí';
                    slotsContainer.appendChild(arrow);
                }
            });
            
            resetStatus();
        }

        // Drag and Drop handlers
        let draggedComponent = null;

        function handleDragStart(e) {
            draggedComponent = e.target.dataset.component;
            e.target.style.opacity = '0.5';
            isDragging = true;
            startAutoScroll();
        }

        function startAutoScroll() {
            // Auto-scroll cuando el mouse est√° cerca de los bordes
            document.addEventListener('dragover', autoScroll);
        }

        function stopAutoScroll() {
            document.removeEventListener('dragover', autoScroll);
            if (autoScrollInterval) {
                clearInterval(autoScrollInterval);
                autoScrollInterval = null;
            }
        }

        function autoScroll(e) {
            const scrollThreshold = 100;
            const scrollSpeed = 10;
            const mouseY = e.clientY;
            const windowHeight = window.innerHeight;

            if (mouseY < scrollThreshold) {
                // Scroll hacia arriba
                window.scrollBy(0, -scrollSpeed);
            } else if (mouseY > windowHeight - scrollThreshold) {
                // Scroll hacia abajo
                window.scrollBy(0, scrollSpeed);
            }
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const slot = e.currentTarget;
            slot.classList.remove('drag-over');
            
            const slotId = slot.dataset.slotId;
            const component = awsComponents.find(c => c.name === draggedComponent);
            
            if (component) {
                // Si el slot ya tiene un componente, lo reemplazamos
                if (slot.classList.contains('filled')) {
                    slot.innerHTML = '';
                }

                // Crear elemento de componente en el slot
                const componentDiv = document.createElement('div');
                componentDiv.className = 'component';
                componentDiv.innerHTML = `
                    <span class="component-icon">${component.icon}</span>
                    <div>${component.name}</div>
                `;
                
                // Agregar evento de click para eliminar
                componentDiv.addEventListener('click', function(e) {
                    e.stopPropagation();
                    removeComponentFromSlot(slot, slotId);
                });
                
                // Limpiar slot y a√±adir componente
                slot.innerHTML = '';
                slot.appendChild(componentDiv);
                slot.classList.add('filled');
                
                // Guardar componente colocado
                placedComponents[slotId] = draggedComponent;
            }
            
            // Restaurar opacidad de todos los componentes
            document.querySelectorAll('.components-grid .component').forEach(c => {
                c.style.opacity = '1';
            });

            isDragging = false;
            stopAutoScroll();
        }

        function removeComponentFromSlot(slot, slotId) {
            slot.innerHTML = `<div class="slot-label">${slot.querySelector('.component').parentElement.dataset.correctComponent}</div>`;
            
            // Restaurar el label correcto desde la arquitectura
            const arch = architectures[currentArchitecture];
            const slotInfo = arch.slots.find(s => s.id === slotId);
            if (slotInfo) {
                slot.innerHTML = `<div class="slot-label">${slotInfo.label}</div>`;
            }
            
            slot.classList.remove('filled');
            delete placedComponents[slotId];
            
            // Efecto visual de eliminaci√≥n
            const ripple = document.createElement('div');
            ripple.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                width: 10px;
                height: 10px;
                border-radius: 50%;
                background: rgba(255, 0, 64, 0.5);
                transform: translate(-50%, -50%);
                animation: rippleOut 0.6s ease-out;
                pointer-events: none;
            `;
            slot.appendChild(ripple);
            setTimeout(() => ripple.remove(), 600);
        }

        // Agregar evento dragend para limpiar
        document.addEventListener('dragend', function(e) {
            document.querySelectorAll('.components-grid .component').forEach(c => {
                c.style.opacity = '1';
            });
            isDragging = false;
            stopAutoScroll();
        });

        // Verificar arquitectura
        function verifyArchitecture() {
            const arch = architectures[currentArchitecture];
            let allCorrect = true;
            let filledSlots = Object.keys(placedComponents).length;
            
            // Verificar si todos los slots est√°n llenos
            if (filledSlots < arch.slots.length) {
                showFeedback('¬°Faltan componentes!', false);
                updateLED(false);
                attemptCount++;
                updateScore();
                updatePlayerStats();
                return;
            }
            
            // Verificar cada slot
            arch.slots.forEach(slot => {
                const placedComponent = placedComponents[slot.id];
                if (placedComponent !== slot.correct) {
                    allCorrect = false;
                }
            });
            
            attemptCount++;
            
            if (allCorrect) {
                correctCount++;
                addCompletedArchitecture(currentArchitecture);
                showFeedback('¬°CORRECTO! üéâ', true, arch.referenceUrl, arch.description);
                updateLED(true);
                
                // Avanzar a la siguiente arquitectura despu√©s de 4 segundos
                setTimeout(() => {
                    if (currentArchitecture < architectures.length - 1) {
                        currentArchitecture++;
                        architectureSelect.value = currentArchitecture;
                        loadArchitecture(currentArchitecture);
                    } else {
                        showFeedback('¬°Completaste todas las arquitecturas! üèÜ', true);
                    }
                }, 4000);
            } else {
                showFeedback('Incorrecto. Intenta de nuevo', false);
                updateLED(false);
            }
            
            updateScore();
            updatePlayerStats();
        }

        // Actualizar LED de estado
        function updateLED(isCorrect) {
            statusLed.className = 'status-led';
            
            setTimeout(() => {
                statusLed.classList.add(isCorrect ? 'correct' : 'incorrect');
            }, 100);
            
            setTimeout(() => {
                statusLed.className = 'status-led';
            }, 2000);
        }

        // Mostrar mensaje de feedback
        function showFeedback(message, isCorrect, referenceUrl = null, description = null) {
            feedbackMessage.innerHTML = `
                <div>${message}</div>
                ${referenceUrl ? `
                    <div class="reference-link">
                        <h4>üìö Arquitectura de Referencia AWS</h4>
                        ${description ? `<p class="reference-description">${description}</p>` : ''}
                        <a href="${referenceUrl}" target="_blank" rel="noopener noreferrer">
                            Ver Documentaci√≥n Oficial ‚Üí
                        </a>
                    </div>
                ` : ''}
            `;
            feedbackMessage.className = 'feedback-message';
            feedbackMessage.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            setTimeout(() => {
                feedbackMessage.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                feedbackMessage.classList.remove('show');
            }, referenceUrl ? 4000 : 2000);
        }

        // Actualizar puntuaci√≥n
        function updateScore() {
            correctCountEl.textContent = correctCount;
            attemptCountEl.textContent = attemptCount;
            const score = attemptCount > 0 ? Math.round((correctCount / attemptCount) * 100) : 0;
            scoreEl.textContent = score;
        }

        // Reset
        function resetStatus() {
            statusLed.className = 'status-led';
        }

        function resetArchitecture() {
            loadArchitecture(currentArchitecture);
        }

        function resetGame() {
            currentArchitecture = 0;
            correctCount = 0;
            attemptCount = 0;
            architectureSelect.value = 0;
            loadArchitecture(0);
            updateScore();
        }

        // Event Listeners
        architectureSelect.addEventListener('change', (e) => {
            currentArchitecture = parseInt(e.target.value);
            loadArchitecture(currentArchitecture);
        });

        verifyBtn.addEventListener('click', verifyArchitecture);
        resetBtn.addEventListener('click', resetArchitecture);

        // Login Modal Events
        playerNicknameInput.addEventListener('input', (e) => {
            const value = e.target.value.trim();
            startGameBtn.disabled = value.length < 2;
        });

        playerNicknameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !startGameBtn.disabled) {
                startGame();
            }
        });

        startGameBtn.addEventListener('click', startGame);

        function startGame() {
            const nickname = playerNicknameInput.value.trim();
            if (nickname.length < 2) return;
            
            createOrUpdatePlayer(nickname);
            currentPlayerName.textContent = nickname;
            loginModal.style.display = 'none';
            leaderboardToggle.style.display = 'flex';
            updateLeaderboard();
            
            // Auto-focus en el primer componente despu√©s de 500ms
            setTimeout(() => {
                const firstComponent = document.querySelector('.component');
                if (firstComponent) firstComponent.focus();
            }, 500);
        }

        // Leaderboard Events
        leaderboardToggle.addEventListener('click', () => {
            leaderboardPanel.classList.add('open');
            updateLeaderboard();
        });

        closeLeaderboard.addEventListener('click', () => {
            leaderboardPanel.classList.remove('open');
        });

        // Cerrar leaderboard al hacer clic fuera
        document.addEventListener('click', (e) => {
            if (leaderboardPanel.classList.contains('open') && 
                !leaderboardPanel.contains(e.target) && 
                !leaderboardToggle.contains(e.target)) {
                leaderboardPanel.classList.remove('open');
            }
        });

        // Admin Panel Events
        adminToggle.addEventListener('click', () => {
            adminPanel.classList.add('open');
            updateAdminStats();
        });

        closeAdmin.addEventListener('click', () => {
            adminPanel.classList.remove('open');
            hideImportSection();
        });

        exportJsonBtn.addEventListener('click', exportToJSON);
        exportCsvBtn.addEventListener('click', exportToCSV);
        importDataBtn.addEventListener('click', showImportSection);
        processImportBtn.addEventListener('click', processImport);
        cancelImportBtn.addEventListener('click', hideImportSection);
        clearAllBtn.addEventListener('click', clearAllData);

        // Close admin panel on ESC key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (adminPanel.classList.contains('open')) {
                    adminPanel.classList.remove('open');
                    hideImportSection();
                }
                if (leaderboardPanel.classList.contains('open')) {
                    leaderboardPanel.classList.remove('open');
                }
            }
        });

        // Iniciar juego
        loadPlayers();
        initGame();
        
        // Mostrar modal de login al inicio
        setTimeout(() => {
            playerNicknameInput.focus();
        }, 300);

        // Mostrar bot√≥n de admin despu√©s del login
        setTimeout(() => {
            adminToggle.style.display = 'flex';
        }, 1000);
    </script>
</body>
</html>
